<!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

- [第8课-根文件系统制作](#第8课-根文件系统制作)
	- [嵌入式系统构成](#嵌入式系统构成)
	- [课程索引](#课程索引)
	- [建立根文件系统目录与文件](#建立根文件系统目录与文件)
		- [创建目录](#创建目录)
		- [创建设备文件](#创建设备文件)
		- [加入配置文件](#加入配置文件)
		- [添加内核模块](#添加内核模块)
		- [编译busybox](#编译busybox)
	- [挂载根文件系统到内核](#挂载根文件系统到内核)
		- [文件系统类型](#文件系统类型)
		- [挂载方式简介](#挂载方式简介)
		- [initramfs挂载](#initramfs挂载)
		- [NFS挂载](#nfs挂载)
	- [总结](#总结)

<!-- /TOC -->

# 第8课-根文件系统制作

## 嵌入式系统构成

![1526610964345.png](image/1526610964345.png)

      根文件系统
        根：指的就是第一个文件系统，Linux可以包含多种文件系统，但是第一个必须得有，不然内核没办法启动
        文件系统：EXT系列，btfs、FAT、NTFS

![1526611152708.png](image/1526611152708.png)

      目录及目录下的所有文件即为文件系统表象

## 课程索引

![1526611126527.png](image/1526611126527.png)

## 建立根文件系统目录与文件

### 创建目录

![1526612275307.png](image/1526612275307.png)

![1526612337930.png](image/1526612337930.png)

### 创建设备文件

      什么是设备文件？
      Linux绝大部分设备会以设备文件的形式存在。操作设备就是对设备增删改查。

![1526612392779.png](image/1526612392779.png)

      mknod 怎么玩儿？？

![1526612476531.png](image/1526612476531.png)

### 加入配置文件

![1526612410579.png](image/1526612410579.png)

![1526612516450.png](image/1526612516450.png)

![1526612551225.png](image/1526612551225.png)

![1526612577467.png](image/1526612577467.png)





### 添加内核模块

![1526612647000.png](image/1526612647000.png)

![1526612690556.png](image/1526612690556.png)

      编译内核模块之后模块是散落在各个子目录当中的。
      需要先安装模块/lib/modules/`uname -r`
      指定安装路径，给出根路径即可

![1526612784041.png](image/1526612784041.png)

![1526612844645.png](image/1526612844645.png)


### 编译busybox

      busybox - 嵌入式开发中的瑞士军刀

![1526612894037.png](image/1526612894037.png)

![1526612899736.png](image/1526612899736.png)

![1526612971406.png](image/1526612971406.png)

![1526612982377.png](image/1526612982377.png)

      必须使用静态

![1526613007212.png](image/1526613007212.png)

      必须指定交叉编译

![1526613028418.png](image/1526613028418.png)

![1526613040383.png](image/1526613040383.png)

      指定安装路径

![1526613088728.png](image/1526613088728.png)

![1526613122927.png](image/1526613122927.png)

      make 编译

![1526613222497.png](image/1526613222497.png)

      make install安装，实际上就是拷贝过程

![1526613265501.png](image/1526613265501.png)

![1526613280161.png](image/1526613280161.png)

## 挂载根文件系统到内核

      Linux系统如何使用这些目录文件？
        选择何种文件系统？

![1526612907593.png](image/1526612907593.png)

![1526613326738.png](image/1526613326738.png)

### 文件系统类型

![1526613408472.png](image/1526613408472.png)

      yaffs2 UbiFS 可读写
      clanfs 只读
      Jffs2 可读写
      内存文件系统中Ramdidsk比较老，将内存模拟成磁盘。
      Ramdisk：划分大小固定，超过无法处理，内存空间浪费
      Initramfs：事先不用指定大小，可以动态扩展，启动速度块。性能更好，多实用它
      网络文件系统nfs：主要是在开发阶段使用


### 挂载方式简介


### initramfs挂载


### NFS挂载


## 总结
