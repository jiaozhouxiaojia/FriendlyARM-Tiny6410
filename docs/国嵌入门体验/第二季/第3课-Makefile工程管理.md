# 第3课-Makefile工程管理

## 课程索引

![1526187393575.png](image/1526187393575.png)

## 为什么要使用Makefile？

![1526187632825.png](image/1526187632825.png)

      裸机程序编译成二进制程序，如果其过程涉及千万步骤，必然不方便使用
      最简单的用shell脚本，类似于批处理
      但是Linux又多了一个Makefile系列工具，除了批出来还增加了很多高级用法。
      这些高级用法都只针对于Makefile使用，有特有的Makefile语法
      大大提高开发效率
      说白了，这东西就是方便开发人员偷懒的工具

![1526187677826.png](image/1526187677826.png)

![1526187421361.png](image/1526187421361.png)

![1526187427018.png](image/1526187427018.png)

      因此，该工具成为Linux编程人员不可获取的工具

## Makefile构成

![1526187818753.png](image/1526187818753.png)

![1526187751081.png](image/1526187751081.png)

### 规则

![1526187796609.png](image/1526187796609.png)

      规律：目标+[依赖]+命令
      Makefile就是由一条一条规则组成

![1526187890353.png](image/1526187890353.png)

      很明显，这个目标是错误的，应该是led.elf

![1526187932961.png](image/1526187932961.png)

### 伪目标

![1526187970073.png](image/1526187970073.png)

### 最终目标

      make 目标名字
      如果没有目标名字，默认选择第一个目标

![1526188193977.png](image/1526188193977.png)

### 变量

      变量也是为了偷懒，少打几个字符，尤其是早起敲键盘特别吃力的年代，少打几个字多活几年

![1526188351208.png](image/1526188351208.png)

      系统自定义的变量，强记，多用就熟悉了。

![1526188430265.png](image/1526188430265.png)

### 通用规则

![1526188511981.png](image/1526188511981.png)

      相同规则合并，比如
          目标和依赖同类型，命令相同便可以用%代替

![1526189163589.png](image/1526189163589.png)

      任何以.S结尾的都会产生.o的文件

![1526189242491.png](image/1526189242491.png)

## Makefile使用技巧

![1526188530486.png](image/1526188530486.png)

### 去掉回显

      # 字符在shell中也是注释，除了第一个
      #!/bin/bash

![1526188544366.png](image/1526188544366.png)

### 指定Makefile

      默认Makefile和makefile都会被make命令识别，其他需要-f选项指定

![1526188564064.png](image/1526188564064.png)
